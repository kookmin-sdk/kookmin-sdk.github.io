<svg width="600" height="900" xmlns="http://www.w3.org/2000/svg">
  <!-- Define styles -->
  <defs>
    <style>
      .box { fill: #f0f4f8; stroke: #667eea; stroke-width: 2; }
      .text { font-family: Arial, sans-serif; font-size: 14px; fill: #333; }
      .title { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #667eea; }
      .arrow { stroke: #333; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .label { font-family: Arial, sans-serif; font-size: 12px; fill: #666; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="300" y="25" text-anchor="middle" class="title">Transformer 디코더 블록 구조</text>

  <!-- Input Layer -->
  <rect x="150" y="50" width="300" height="50" class="box" rx="5"/>
  <text x="300" y="82" text-anchor="middle" class="text">입력: Embeddings + Positional Encoding</text>

  <!-- Arrow -->
  <path d="M 300 100 L 300 130" class="arrow"/>

  <!-- Multi-Head Self-Attention -->
  <rect x="100" y="130" width="400" height="70" class="box" rx="5"/>
  <text x="300" y="155" text-anchor="middle" class="title">Multi-Head Self-Attention</text>
  <text x="300" y="175" text-anchor="middle" class="label">Q = X·W^Q,  K = X·W^K,  V = X·W^V</text>
  <text x="300" y="190" text-anchor="middle" class="label">Attention(Q,K,V) = softmax(QK^T/√d_k)·V</text>

  <!-- Arrow -->
  <path d="M 300 200 L 300 230" class="arrow"/>

  <!-- Residual & Add -->
  <circle cx="280" cy="260" r="20" fill="#e8f4f8" stroke="#667eea" stroke-width="2"/>
  <text x="280" y="266" text-anchor="middle" class="label">+</text>
  <path d="M 150 180 Q 80 220 270 260" class="arrow" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <text x="100" y="215" class="label">Residual</text>

  <!-- Arrow -->
  <path d="M 300 280 L 300 310" class="arrow"/>

  <!-- Layer Normalization -->
  <rect x="200" y="310" width="200" height="40" class="box" rx="5"/>
  <text x="300" y="338" text-anchor="middle" class="text">Layer Normalization</text>

  <!-- Arrow -->
  <path d="M 300 350 L 300 380" class="arrow"/>

  <!-- Feed Forward Network -->
  <rect x="50" y="380" width="500" height="90" class="box" rx="5"/>
  <text x="300" y="410" text-anchor="middle" class="title">Feed Forward Network (FFN)</text>
  <text x="300" y="435" text-anchor="middle" class="label">FFN(x) = max(0, x·W₁ + b₁)·W₂ + b₂</text>
  <text x="300" y="455" text-anchor="middle" class="label">• First Layer: d_model → 4·d_model (expansion)</text>
  <text x="300" y="470" text-anchor="middle" class="label">• Second Layer: 4·d_model → d_model (reduction)</text>

  <!-- Arrow -->
  <path d="M 300 470 L 300 500" class="arrow"/>

  <!-- Residual & Add -->
  <circle cx="280" cy="530" r="20" fill="#e8f4f8" stroke="#667eea" stroke-width="2"/>
  <text x="280" y="536" text-anchor="middle" class="label">+</text>
  <path d="M 300 350 Q 350 440 290 530" class="arrow" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <text x="360" y="440" class="label">Residual</text>

  <!-- Arrow -->
  <path d="M 300 550 L 300 580" class="arrow"/>

  <!-- Layer Normalization 2 -->
  <rect x="200" y="580" width="200" height="40" class="box" rx="5"/>
  <text x="300" y="608" text-anchor="middle" class="text">Layer Normalization</text>

  <!-- Arrow -->
  <path d="M 300 620 L 300 650" class="arrow"/>

  <!-- Output Layer -->
  <rect x="150" y="650" width="300" height="50" class="box" rx="5"/>
  <text x="300" y="682" text-anchor="middle" class="text">출력: Context-aware Embeddings</text>

  <!-- Legend -->
  <text x="50" y="750" class="title">주요 특징:</text>
  <text x="50" y="775" class="label">• 잔차 연결(Residual Connection): 깊은 네트워크 학습 안정화</text>
  <text x="50" y="795" class="label">• 레이어 정규화: 활성화 값의 분포를 안정화</text>
  <text x="50" y="815" class="label">• 멀티-헤드 어텐션: 다양한 관계 학습 (병렬 처리)</text>
  <text x="50" y="835" class="label">• FFN: 각 위치별 독립적인 비선형 변환</text>
  <text x="50" y="855" class="label">• 이 블록을 여러 층(L층) 스택하여 깊은 모델 구성</text>
</svg>